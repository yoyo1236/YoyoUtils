{"ts":1349497815859,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿package com.yoyo.utils;\r\n\r\nimport java.io.BufferedInputStream;\r\nimport java.io.BufferedOutputStream;\r\nimport java.io.BufferedReader;\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\nimport java.io.FileOutputStream;\r\nimport java.io.FileReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.io.RandomAccessFile;\r\nimport java.io.Reader;\r\n\r\n\r\n/**\r\n* FileUtils: (文件处理类)\r\n* @author yoyo E-mail:152106619@qq.com\r\n* @version 创建时间：2012-8-17 上午10:12:31\r\n*/\r\npublic class FileUtils {\r\n\t/**\r\n\t* @Title readFileByBytes\r\n\t* @Description 以字节为单位读取文件，常用于读二进制文件，如图片、声音、影像等文件。\r\n\t* @return String 文件内容\r\n\t* @param fileName 文件路径\r\n\t* @return\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:38:41\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static String readFileByBytes(String fileName) {\r\n\t\tFile file = new File(fileName);\r\n\t\tInputStream in = null;\r\n\t\ttry {\r\n\t\t\tSystem.out.println(\"以字节为单位读取文件内容，一次读一个字节：\");\r\n\t\t\t// 一次读一个字节\r\n\t\t\tin = new FileInputStream(file);\r\n\t\t\tint tempbyte;\r\n\t\t\twhile ((tempbyte = in.read()) != -1) {\r\n\t\t\t\tSystem.out.write(tempbyte);\r\n\t\t\t}\r\n\t\t\tin.close();\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\t// 一次读多个字节\r\n\t\t\tbyte[] tempbytes = new byte[100];\r\n\t\t\tin = new FileInputStream(fileName);\r\n\t\t\tFileUtils.showAvailableBytes(in);\r\n\t\t\t// 读入多个字节到字节数组中，byteread为一次读入的字节数\r\n\t\t\twhile (in.read(tempbytes) != -1) {\r\n\t\t\t\t// System.out.write(tempbytes, 0, byteread);\r\n\t\t\t}\r\n\t\t\treturn new String(tempbytes, \"ISO-8859-1\");\r\n\t\t} catch (Exception e1) {\r\n\t\t\te1.printStackTrace();\r\n\t\t} finally {\r\n\t\t\tif (in != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tin.close();\r\n\t\t\t\t} catch (IOException e1) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// return new String(tempbytes);\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t* @Title readFileByChars\r\n\t* @Description 以字符为单位读取文件，常用于读文本，数字等类型的文件\r\n\t* @return String 文件内容\r\n\t* @param fileName 文件路径\r\n\t* @return\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:39:28\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static String readFileByChars(String fileName) {\r\n\t\tFile file = new File(fileName);\r\n\t\tReader reader = null;\r\n\t\tString content = null;\r\n\t\ttry {\r\n\t\t\tSystem.out.println(\"以字符为单位读取文件内容，一次读一个字节：\");\r\n\t\t\t// 一次读一个字符\r\n\t\t\treader = new InputStreamReader(new FileInputStream(file));\r\n\t\t\tint tempchar;\r\n\t\t\twhile ((tempchar = reader.read()) != -1) {\r\n\t\t\t\t// 对于windows下，\\r\\n这两个字符在一起时，表示一个换行。\r\n\t\t\t\t// 但如果这两个字符分开显示时，会换两次行。\r\n\t\t\t\t// 因此，屏蔽掉\\r，或者屏蔽\\n。否则，将会多出很多空行。\r\n\t\t\t\tcontent += tempchar;\r\n\t\t\t}\r\n\t\t\treader.close();\r\n\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\t/*\r\n\t\t * try { System.out.println(\"以字符为单位读取文件内容，一次读多个字节：\"); // 一次读多个字符 char[]\r\n\t\t * tempchars = new char[30]; int charread = 0; reader = new\r\n\t\t * InputStreamReader(new FileInputStream(fileName)); //\r\n\t\t * 读入多个字符到字符数组中，charread为一次读取字符数 while ((charread =\r\n\t\t * reader.read(tempchars)) != -1) { // 同样屏蔽掉\\r不显示 if ((charread ==\r\n\t\t * tempchars.length) && (tempchars[tempchars.length - 1] != '\\r')) {\r\n\t\t * System.out.print(tempchars); } else { for (int i = 0; i < charread;\r\n\t\t * i++) { if (tempchars[i] == '\\r') { continue; } else {\r\n\t\t * System.out.print(tempchars[i]); } } } }\r\n\t\t * \r\n\t\t * } catch (Exception e1) { e1.printStackTrace(); }\r\n\t\t */\r\n\t\tfinally {\r\n\t\t\tif (reader != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treader.close();\r\n\t\t\t\t} catch (IOException e1) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n\r\n\t/**\r\n\t* @Title readFileByLines\r\n\t* @Description 以行为单位读取文件，常用于读面向行的格式化文件\r\n\t* @return String 文件内容\r\n\t* @param fileName 文件路径\r\n\t* @return\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:39:55\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static String readFileByLines(String fileName) {\r\n\t\tFile file = new File(fileName);\r\n\t\tBufferedReader reader = null;\r\n\t\tString content = null;\r\n\t\ttry {\r\n\t\t\tSystem.out.println(\"以行为单位读取文件内容，一次读一整行：\");\r\n\t\t\treader = new BufferedReader(new FileReader(file));\r\n\t\t\tString tempString = null;\r\n\t\t\t// 一次读入一行，直到读入null为文件结束\r\n\t\t\twhile ((tempString = reader.readLine()) != null) {\r\n\t\t\t\t// 显示行号\r\n\t\t\t\t// System.out.println(\"line \" + line + \": \" + tempString);\r\n\t\t\t\tcontent += tempString;\r\n\t\t\t}\r\n\t\t\treader.close();\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t} finally {\r\n\t\t\tif (reader != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treader.close();\r\n\t\t\t\t} catch (IOException e1) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n\r\n\t/**\r\n\t* @Title readFileByRandomAccess\r\n\t* @Description 随机读取文件内容\r\n\t* @return String 文件内容\r\n\t* @param fileName 文件路径\r\n\t* @return\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:40:19\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static String readFileByRandomAccess(String fileName) {\r\n\t\tRandomAccessFile randomFile = null;\r\n\t\tString content = null;\r\n\t\ttry {\r\n\t\t\tSystem.out.println(\"随机读取一段文件内容：\");\r\n\t\t\t// 打开一个随机访问文件流，按只读方式\r\n\t\t\trandomFile = new RandomAccessFile(fileName, \"r\");\r\n\t\t\t// 文件长度，字节数\r\n\t\t\tlong fileLength = randomFile.length();\r\n\t\t\t// 读文件的起始位置\r\n\t\t\tint beginIndex = (fileLength > 4) ? 4 : 0;\r\n\t\t\t// 将读文件的开始位置移到beginIndex位置。\r\n\t\t\trandomFile.seek(beginIndex);\r\n\t\t\tbyte[] bytes = new byte[10];\r\n\t\t\tint byteread = 0;\r\n\t\t\t// 一次读10个字节，如果文件内容不足10个字节，则读剩下的字节。\r\n\t\t\t// 将一次读取的字节数赋给byteread\r\n\t\t\twhile ((byteread = randomFile.read(bytes)) != -1) {\r\n\t\t\t\tSystem.out.write(bytes, 0, byteread);\r\n\t\t\t\tcontent += bytes;\r\n\t\t\t}\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t} finally {\r\n\t\t\tif (randomFile != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trandomFile.close();\r\n\t\t\t\t} catch (IOException e1) {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n\r\n\t/**\r\n\t * 显示输入流中还剩的字节数\r\n\t */\r\n\tprivate static void showAvailableBytes(InputStream in) {\r\n\t\ttry {\r\n\t\t\tSystem.out.println(\"当前字节输入流中的字节数为:\" + in.available());\r\n\t\t} catch (IOException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t* @Title readFile\r\n\t* @Description 读取源文件内容\r\n\t* 通过 new String(bytes, \"ISO-8859-1\") 转换成String类型\r\n\t* @return String 文件内容\r\n\t* @param fileName 文件路径\r\n\t* @return\r\n\t* @throws IOException\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:35:11\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static byte[] readFile(String fileName) throws IOException {\r\n\t\tFile file = new File(fileName);\r\n\t\tif (fileName == null || fileName.equals(\"\")) {\r\n\t\t\tthrow new NullPointerException(\"无效的文件路径\");\r\n\t\t}\r\n\t\tlong len = file.length();\r\n\t\tbyte[] bytes = new byte[(int) len];\r\n\r\n\t\tBufferedInputStream bufferedInputStream = new BufferedInputStream(\r\n\t\t\t\tnew FileInputStream(file));\r\n\t\tint r = bufferedInputStream.read(bytes);\r\n\t\tif (r != len) {\r\n\t\t\tthrow new IOException(\"读取文件不正确\");\r\n\t\t}\r\n\t\tbufferedInputStream.close();\r\n\r\n\t\treturn bytes;\r\n\t}\r\n\r\n\t/**\r\n\t* @Title writeFile\r\n\t* @Description 将数据写入文件\r\n\t* 输入new String(写入内容, \"ISO-8859-1\").getBytes()\r\n\t* @return void\r\n\t* @param data 写入内容\r\n\t* @param filename 文件路径\r\n\t* @throws IOException\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:40:45\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic static void writeFile(byte[] data, String filename)\r\n\t\t\tthrows IOException {\r\n\t\tFile file = new File(filename);\r\n\t\tfile.getParentFile().mkdirs();\r\n\t\tBufferedOutputStream bufferedOutputStream = new BufferedOutputStream(\r\n\t\t\t\tnew FileOutputStream(file));\r\n\t\tbufferedOutputStream.write(data);\r\n\t\tbufferedOutputStream.close();\r\n\t}\r\n\r\n\t/**\r\n\t* @Title readFileJar\r\n\t* @Description 从jar文件里读取class\r\n\t* 通过 new String(bytes, \"ISO-8859-1\") 转换成String类型\r\n\t* @return byte[] 文件内容\r\n\t* @param filename 文件路径\r\n\t* @return\r\n\t* @throws IOException\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:41:22\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic byte[] readFileJar(String filename) throws IOException {\r\n\t\tBufferedInputStream bufferedInputStream = new BufferedInputStream(\r\n\t\t\t\tgetClass().getResource(filename).openStream());\r\n\t\tint len = bufferedInputStream.available();\r\n\t\tbyte[] bytes = new byte[len];\r\n\t\tint r = bufferedInputStream.read(bytes);\r\n\t\tif (len != r) {\r\n\t\t\tbytes = null;\r\n\t\t\tthrow new IOException(\"读取文件不正确\");\r\n\t\t}\r\n\t\tbufferedInputStream.close();\r\n\t\treturn bytes;\r\n\t}\r\n\r\n\t/**\r\n\t* @Title readUrlStream\r\n\t* @Description 读取网络流，为了防止中文的问题，在读取过程中没有进行编码转换，而且采取了动态的byte[]的方式获得所有的byte返回\r\n\t* 通过 new String(bytes, \"ISO-8859-1\") 转换成String类型\r\n\t* @return byte[] 内容\r\n\t* @param bufferedInputStream 输入流\r\n\t* @return\r\n\t* @throws IOException\r\n\t* @author yoyo Email:152106619@qq.com\r\n\t* @date 2012-8-17 上午11:41:51\r\n\t* @ModificationHistory\r\n\t* Date  Author  Version  Description\r\n\t* ---------------------------------------------------------*\r\n\t* 2012-8-17  yoyo Email:152106619@qq.com v1.0.0   修改原因\r\n\t*/\r\n\tpublic byte[] readUrlStream(BufferedInputStream bufferedInputStream)\r\n\t\t\tthrows IOException {\r\n\t\tbyte[] bytes = new byte[100];\r\n\t\tbyte[] bytecount = null;\r\n\t\tint n = 0;\r\n\t\tint ilength = 0;\r\n\t\twhile ((n = bufferedInputStream.read(bytes)) >= 0) {\r\n\t\t\tif (bytecount != null) {\r\n\t\t\t\tilength = bytecount.length;\r\n\t\t\t}\r\n\t\t\tbyte[] tempbyte = new byte[ilength + n];\r\n\t\t\tif (bytecount != null) {\r\n\t\t\t\tSystem.arraycopy(bytecount, 0, tempbyte, 0, ilength);\r\n\t\t\t}\r\n\r\n\t\t\tSystem.arraycopy(bytes, 0, tempbyte, ilength, n);\r\n\t\t\tbytecount = tempbyte;\r\n\r\n\t\t\tif (n < bytes.length) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn bytecount;\r\n\t}\r\n\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":10103}]],"length":10103}
{"contributors":[],"silentsave":false,"ts":1349497878350,"patch":[[{"diffs":[[-1,"﻿"],[0,"pack"]],"start1":0,"start2":0,"length1":5,"length2":4},{"diffs":[[0,"t;\r\n\t}\r\n"],[-1,"\r\n"],[0,"}"]],"start1":10091,"start2":10091,"length1":11,"length2":9}]],"length":10100,"saved":false}
{"ts":1349498046623,"patch":[[{"diffs":[[0,";\r\n\t}\r\n}"],[1,"\r\n\r\n"]],"start1":10092,"start2":10092,"length1":8,"length2":12}]],"length":10104,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349498127394,"patch":[[{"diffs":[[0,";\r\n\t}\r\n}\r\n\r\n"],[1,"\r\n"]],"start1":10092,"start2":10092,"length1":12,"length2":14}]],"length":10106,"saved":false}
{"ts":1349498133729,"patch":[[{"diffs":[[0,"\n\t}\r\n}\r\n\r\n\r\n"],[1,"d"]],"start1":10094,"start2":10094,"length1":12,"length2":13}]],"length":10107,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349500308610,"patch":[[{"diffs":[[0,"}\r\n}\r\n\r\n"],[1," "],[0,"\r\nd"]],"start1":10096,"start2":10096,"length1":11,"length2":12}]],"length":10108,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349502644080,"patch":[[{"diffs":[[0,"der;\r\n\r\n"],[-1,"\r\n"],[0,"/**\r\n* F"]],"start1":396,"start2":396,"length1":18,"length2":16}]],"length":10106,"saved":false}
{"ts":1349502669271,"patch":[[{"diffs":[[0,"eader;\r\n"],[1," "],[0,"\r\n/**\r\n*"]],"start1":394,"start2":394,"length1":16,"length2":17}]],"length":10107,"saved":false}
{"ts":1349502680913,"patch":[[{"diffs":[[0,"\r\n\r\n \r\nd"],[1,"dd"]],"start1":10099,"start2":10099,"length1":8,"length2":10}]],"length":10109,"saved":false}
